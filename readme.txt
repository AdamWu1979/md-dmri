Multidimensional Diffusion MRI analysis framework (MD-MRI)
----------------------------------------------------------

Authors:
Markus Nilsson
Daniel Topgaard
Samo Lasic
Andre Ahlgren
Filip Szczepankiewicz
Carl-Fredrik Westin

This package contains MATLAB files to help users analyze multidimensional
diffusion MRI data. The character of such data can vary. For example, it 
can be a regular DTI scan. However, we rather target data acquired with
e.g. b-tensors of varying shape, or FEXI where the mixing time adds an
acquisition dimension as compared to regular DWI.

We envision the following usage scenario. The functions herein support 
step 3 and 4.

1. Define an experiental protocol by selecting b-values, echo times, 
   image resolution et c. Suggested protocols for MD-MRI can be found on 
   our website: http://www.multidimensionalmri.org/

2. Run the protocol and acquire data in some native format, for example, 
   DICOM. Unfortunately, all parameters needed to analyse the
   data may not be stored in the DICOM. For example, the mixing time in a
   FEXI experiment may not be in the DICOM header. The user need to find
   some way to connect this extra data to the image data. The fields needed
   for each model is listed in functions called *_check_xps.m, where
   here * is e.g. dti_nls, fexi, et c. 

3. Convert the data to the format supported in this framework. We supply
   functions to assist in this process, found under the 'multidimensional
   data management' (mdm) package. 

   Example for a DTI-scan where gradient directions and b-values are stored
   in a gdir file (n_x, n_y, n_z, b)

        s.nii_fn = 'my_dti_scan.nii';
        s.xps    = mdm_xps_from_gdir('my_dti_scan_gdir.txt');

   The s-structure is now ready to enter a pipeline. The xps structure 
   contains the experiment parameters.

4. Execute a pipeline function. You find the pipelines under e.g. 
   models/dti_nls/dti_nls_pipe_example.m. The naming convention here is
   that the prefix 'dti_nls' tells something about the model/fitting, and
   the suffix about what is being done. Example:

        dti_nls_pipe_example(s, output_path);

   The pipeline generates a .mat-file with a model-fit structure (mfs). 
   This model-fit structure is generated by a function called e.g. 
   *_4d_data2fit.

   From the model-fit structure, several parameter volumes can be generated
   for further analysis. This is done using functions named e.g.
   *_4d_fit2param. 

5. Analyze the data by drawing ROIs or using other analysis packages of 
   your choise.


We suggest you start analysing the model found in models/dti_nls to get
an understanding of the model structure.
